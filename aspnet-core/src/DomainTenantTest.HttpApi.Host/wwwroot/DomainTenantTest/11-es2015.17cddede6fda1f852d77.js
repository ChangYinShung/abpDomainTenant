(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{kuRq:function(e,t,n){"use strict";n.r(t);var i=n("HmNo"),s=n("fXoL"),c=n("AcyG"),o=n("mrSG"),r=n("1REP"),a=n("3Pt+"),l=n("HDdC"),b=n("vkgz"),d=n("wO+i"),p=n("nYR2"),u=n("eIep"),m=n("IzEk"),h=n("tyNb"),y=n("iWZL"),g=n("350m"),f=n("1kSV"),j=n("lJxs"),v=n("ofXK");function C(e,t){if(1&e&&(s.Vb(0,"h4"),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()),2&e){const e=s.jc().ngIf;s.Cb(1),s.Kc(" ",s.lc(2,2,"AbpPermissionManagement::Permissions")," - ",e.entityName," ")}}function U(e,t){if(1&e){const e=s.Wb();s.Vb(0,"li",20),s.Vb(1,"a",21),s.hc("click",(function(){s.zc(e);const n=t.$implicit;return s.jc(3).onChangeGroup(n)})),s.Hc(2),s.Ub(),s.Ub()}if(2&e){const e=t.$implicit,n=s.jc(3);s.Cb(1),s.Hb("active",(null==n.selectedGroup?null:n.selectedGroup.name)===(null==e?null:e.name)),s.Cb(1),s.Ic(null==e?null:e.displayName)}}function O(e,t){if(1&e&&(s.Vb(0,"span",26),s.Hc(1),s.Ub()),2&e){const e=t.$implicit;s.Cb(1),s.Kc("",e.providerName,": ",e.providerKey,"")}}function I(e,t){if(1&e&&(s.Tb(0),s.Fc(1,O,2,2,"span",25),s.Sb()),2&e){const e=s.jc().$implicit;s.Cb(1),s.pc("ngForOf",e.grantedProviders)}}function k(e,t){if(1&e){const e=s.Wb();s.Vb(0,"div",5),s.Qb(1,"input",22,23),s.Vb(3,"label",24),s.hc("click",(function(){s.zc(e);const n=t.$implicit,i=s.yc(2);return s.jc(3).onClickCheckbox(n,i.value)})),s.Hc(4),s.Fc(5,I,2,1,"ng-container",1),s.Ub(),s.Ub()}if(2&e){const e=t.$implicit,n=s.jc(3);s.Ec("margin-left",e.margin+"px"),s.Cb(1),s.pc("checked",n.getChecked(e.name))("value",n.getChecked(e.name))("disabled",n.isGrantedByOtherProviderName(e.grantedProviders)),s.Db("id",e.name),s.Cb(2),s.Db("for",e.name),s.Cb(1),s.Jc("",e.displayName," "),s.Cb(1),s.pc("ngIf",!n.hideBadges)}}function V(e,t){if(1&e){const e=s.Wb();s.Vb(0,"div",5),s.Vb(1,"input",6),s.hc("ngModelChange",(function(t){return s.zc(e),s.jc(2).selectAllTab=t}))("click",(function(){return s.zc(e),s.jc(2).onClickSelectAll()})),s.Ub(),s.Vb(2,"label",7),s.Hc(3),s.kc(4,"abpLocalization"),s.Ub(),s.Ub(),s.Qb(5,"hr",8),s.Vb(6,"div",9),s.Vb(7,"div",10),s.Vb(8,"ul",11),s.Fc(9,U,3,3,"li",12),s.kc(10,"async"),s.Ub(),s.Ub(),s.Vb(11,"div",13),s.Vb(12,"h4"),s.Hc(13),s.Ub(),s.Qb(14,"hr",14),s.Vb(15,"div",15),s.Vb(16,"div",5),s.Vb(17,"input",16),s.hc("ngModelChange",(function(t){return s.zc(e),s.jc(2).selectThisTab=t}))("click",(function(){return s.zc(e),s.jc(2).onClickSelectThisTab()})),s.Ub(),s.Vb(18,"label",17),s.Hc(19),s.kc(20,"abpLocalization"),s.Ub(),s.Ub(),s.Qb(21,"hr",18),s.Fc(22,k,6,9,"div",19),s.kc(23,"async"),s.Ub(),s.Ub(),s.Ub()}if(2&e){const e=s.jc(2);s.Cb(1),s.pc("ngModel",e.selectAllTab),s.Cb(2),s.Ic(s.lc(4,9,"AbpPermissionManagement::SelectAllInAllTabs")),s.Cb(6),s.pc("ngForOf",s.lc(10,11,e.groups$))("ngForTrackBy",e.trackByFn),s.Cb(4),s.Ic(null==e.selectedGroup?null:e.selectedGroup.displayName),s.Cb(4),s.pc("ngModel",e.selectThisTab),s.Cb(2),s.Ic(s.lc(20,13,"AbpPermissionManagement::SelectAllInThisTab")),s.Cb(3),s.pc("ngForOf",s.lc(23,15,e.selectedGroupPermissions$))("ngForTrackBy",e.trackByFn)}}function w(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",27,28),s.Hc(2),s.kc(3,"abpLocalization"),s.Ub(),s.Vb(4,"abp-button",29),s.hc("click",(function(){return s.zc(e),s.jc(2).submit()})),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub()}2&e&&(s.Cb(2),s.Jc(" ",s.lc(3,2,"AbpIdentity::Cancel")," "),s.Cb(3),s.Ic(s.lc(6,4,"AbpIdentity::Save")))}function R(e,t){1&e&&(s.Tb(0),s.Fc(1,C,3,4,"ng-template",null,2,s.Gc),s.Fc(3,V,24,17,"ng-template",null,3,s.Gc),s.Fc(5,w,7,6,"ng-template",null,4,s.Gc),s.Sb())}const P=function(e){return{entityName:e}};let S=(()=>{class e{constructor(e){this.payload=e}}return e.type="[PermissionManagement] Get Permissions",e})(),F=(()=>{class e{constructor(e){this.payload=e}}return e.type="[PermissionManagement] Update Permissions",e})(),A=(()=>{class e{constructor(e){this.rest=e}getPermissions(e){return this.rest.request({method:"GET",url:"/api/abp/permissions",params:e})}updatePermissions({permissions:e,providerKey:t,providerName:n}){return this.rest.request({method:"PUT",url:"/api/abp/permissions",body:{permissions:e},params:{providerKey:t,providerName:n}})}}return e.\u0275fac=function(t){return new(t||e)(s.dc(i.x))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e.ngInjectableDef=Object(s.Lb)({factory:function(){return new e(Object(s.dc)(i.x))},token:e,providedIn:"root"}),e})(),G=(()=>{let e=class{constructor(e){this.permissionManagementService=e}static getPermissionGroups({permissionRes:e}){return e.groups||[]}static getEntityDisplayName({permissionRes:e}){return e.entityDisplayName}permissionManagementGet({patchState:e},{payload:t}){return this.permissionManagementService.getPermissions(t).pipe(Object(b.a)(t=>e({permissionRes:t})))}permissionManagementUpdate(e,{payload:t}){return this.permissionManagementService.updatePermissions(t)}};return e.\u0275fac=function(t){return new(t||e)(s.dc(A))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac}),Object(o.b)([Object(c.a)(S),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,S]),Object(o.c)("design:returntype",void 0)],e.prototype,"permissionManagementGet",null),Object(o.b)([Object(c.a)(F),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,F]),Object(o.c)("design:returntype",void 0)],e.prototype,"permissionManagementUpdate",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",void 0)],e,"getPermissionGroups",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",String)],e,"getEntityDisplayName",null),e=Object(o.b)([Object(c.h)({name:"PermissionManagementState",defaults:{permissionRes:{}}})],e),e})(),T=(()=>{class e{constructor(e,t){this.store=e,this.renderer=t,this.hideBadges=!1,this._visible=!1,this.visibleChange=new s.p,this.permissions=[],this.selectThisTab=!1,this.selectAllTab=!1,this.modalBusy=!1,this.trackByFn=(e,t)=>t.name}get visible(){return this._visible}set visible(e){e!==this._visible&&(e?this.openModal().subscribe(()=>{this._visible=!0,this.visibleChange.emit(!0)}):(this.selectedGroup=null,this._visible=!1,this.visibleChange.emit(!1)))}get selectedGroupPermissions$(){return this.groups$.pipe(Object(j.a)(e=>this.selectedGroup?e.find(e=>e.name===this.selectedGroup.name).permissions:[]),Object(j.a)(e=>e.map(t=>Object.assign({},t,{margin:N(e,t),isGranted:this.permissions.find(e=>e.name===t.name).isGranted}))))}getChecked(e){return(this.permissions.find(t=>t.name===e)||{isGranted:!1}).isGranted}isGrantedByOtherProviderName(e){return!!e.length&&e.findIndex(e=>e.providerName!==this.providerName)>-1}onClickCheckbox(e,t){e.isGranted&&this.isGrantedByOtherProviderName(e.grantedProviders)||setTimeout(()=>{this.permissions=this.permissions.map(t=>e.name===t.name?Object.assign({},t,{isGranted:!t.isGranted}):e.name===t.parentName&&e.isGranted?Object.assign({},t,{isGranted:!1}):e.parentName!==t.name||e.isGranted?t:Object.assign({},t,{isGranted:!0})),this.setTabCheckboxState(),this.setGrantCheckboxState()},0)}setTabCheckboxState(){this.selectedGroupPermissions$.pipe(Object(m.a)(1)).subscribe(e=>{const t=e.filter(e=>e.isGranted),n=document.querySelector("#select-all-in-this-tabs");t.length===e.length?(n.indeterminate=!1,this.selectThisTab=!0):0===t.length?(n.indeterminate=!1,this.selectThisTab=!1):n.indeterminate=!0})}setGrantCheckboxState(){const e=this.permissions.filter(e=>e.isGranted),t=document.querySelector("#select-all-in-all-tabs");e.length===this.permissions.length?(t.indeterminate=!1,this.selectAllTab=!0):0===e.length?(t.indeterminate=!1,this.selectAllTab=!1):t.indeterminate=!0}onClickSelectThisTab(){this.selectedGroupPermissions$.pipe(Object(m.a)(1)).subscribe(e=>{e.forEach(e=>{if(e.isGranted&&this.isGrantedByOtherProviderName(e.grantedProviders))return;const t=this.permissions.findIndex(t=>t.name===e.name);this.permissions=[...this.permissions.slice(0,t),Object.assign({},this.permissions[t],{isGranted:!this.selectThisTab}),...this.permissions.slice(t+1)]})}),this.setGrantCheckboxState()}onClickSelectAll(){this.permissions=this.permissions.map(e=>Object.assign({},e,{isGranted:this.isGrantedByOtherProviderName(e.grantedProviders)||!this.selectAllTab})),this.selectThisTab=!this.selectAllTab}onChangeGroup(e){this.selectedGroup=e,this.setTabCheckboxState()}submit(){this.modalBusy=!0;const e=L(this.store.selectSnapshot(G.getPermissionGroups)),t=this.permissions.filter(t=>e.find(e=>e.name===t.name).isGranted!==t.isGranted).map(({name:e,isGranted:t})=>({name:e,isGranted:t}));t.length?this.store.dispatch(new F({providerKey:this.providerKey,providerName:this.providerName,permissions:t})).pipe(Object(p.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.visible=!1}):(this.modalBusy=!1,this.visible=!1)}openModal(){if(!this.providerKey||!this.providerName)throw new Error("Provider Key and Provider Name are required.");return this.store.dispatch(new S({providerKey:this.providerKey,providerName:this.providerName})).pipe(Object(d.a)("PermissionManagementState","permissionRes"),Object(b.a)(e=>{this.selectedGroup=e.groups[0],this.permissions=L(e.groups)}))}initModal(){this.setTabCheckboxState(),this.setGrantCheckboxState()}}return e.\u0275fac=function(t){return new(t||e)(s.Pb(c.j),s.Pb(s.F))},e.\u0275cmp=s.Jb({type:e,selectors:[["abp-permission-management"]],inputs:{hideBadges:"hideBadges",visible:"visible",providerName:"providerName",providerKey:"providerKey"},outputs:{visibleChange:"visibleChange"},exportAs:["abpPermissionManagement"],decls:3,vars:7,consts:[[3,"visible","busy","visibleChange","init"],[4,"ngIf"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"custom-checkbox","custom-control","mb-2"],["type","checkbox","id","select-all-in-all-tabs","name","select-all-in-all-tabs",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","select-all-in-all-tabs",1,"custom-control-label"],[1,"mt-2","mb-2"],[1,"row"],[1,"col-md-4"],[1,"nav","nav-pills","flex-column"],["class","nav-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-8"],[1,"mt-2","mb-3"],[1,"pl-1","pt-1"],["type","checkbox","id","select-all-in-this-tabs","name","select-all-in-this-tabs",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","select-all-in-this-tabs",1,"custom-control-label"],[1,"mb-3"],["class","custom-checkbox custom-control mb-2",3,"margin-left",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nav-item"],[1,"nav-link","pointer",3,"click"],["type","checkbox",1,"custom-control-input",3,"checked","value","disabled"],["permissionCheckbox",""],[1,"custom-control-label",3,"click"],["class","badge badge-light",4,"ngFor","ngForOf"],[1,"badge","badge-light"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"click"]],template:function(e,t){1&e&&(s.Vb(0,"abp-modal",0),s.hc("visibleChange",(function(e){return t.visible=e}))("init",(function(){return t.initModal()})),s.Fc(1,R,7,0,"ng-container",1),s.kc(2,"async"),s.Ub()),2&e&&(s.pc("visible",t.visible)("busy",t.modalBusy),s.Cb(1),s.pc("ngIf",s.tc(5,P,s.lc(2,3,t.entityName$))))},directives:[r.h,v.n,a.a,a.n,a.q,v.m,r.b],pipes:[v.b,i.o],encapsulation:2}),Object(o.b)([Object(c.f)(G.getPermissionGroups),Object(o.c)("design:type",l.a)],e.prototype,"groups$",void 0),Object(o.b)([Object(c.f)(G.getEntityDisplayName),Object(o.c)("design:type",l.a)],e.prototype,"entityName$",void 0),e})();function N(e,t){const n=e.find(e=>e.name===t.parentName);if(n&&n.parentName){let t=20;return t+=N(e,n)}return n?20:0}function L(e){return e.reduce((e,t)=>[...e,...t.permissions],[])}let z=(()=>{class e{}return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[i.f,r.l,c.e.forFeature([G])]]}),e})();var x;!function(e){e.State=function(){},e.Response=function(){},e.Group=function(){},e.MinimumPermission=function(){},e.Permission=function(){},e.GrantedProvider=function(){},e.UpdateRequest=function(){},e.PermissionManagementComponentInputs=function(){},e.PermissionManagementComponentOutputs=function(){}}(x||(x={})),n.d(t,"CreateRole",(function(){return ze})),n.d(t,"CreateUser",(function(){return Ke})),n.d(t,"DeleteRole",(function(){return Le})),n.d(t,"DeleteUser",(function(){return De})),n.d(t,"GetRoleById",(function(){return Ne})),n.d(t,"GetRoles",(function(){return Te})),n.d(t,"GetUserById",(function(){return He})),n.d(t,"GetUserRoles",(function(){return $e})),n.d(t,"GetUsers",(function(){return Me})),n.d(t,"IdentityModule",(function(){return Ye})),n.d(t,"IdentityService",(function(){return Ee})),n.d(t,"IdentityState",(function(){return qe})),n.d(t,"IdentityStateService",(function(){return Ze})),n.d(t,"RolesComponent",(function(){return Qe})),n.d(t,"UpdateRole",(function(){return xe})),n.d(t,"UpdateUser",(function(){return Be})),n.d(t,"UsersComponent",(function(){return We})),n.d(t,"\u0275a",(function(){return Qe})),n.d(t,"\u0275b",(function(){return Ee})),n.d(t,"\u0275d",(function(){return We})),n.d(t,"\u0275e",(function(){return _e}));const M=["formRef"];function H(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",14),s.hc("click",(function(){return s.zc(e),s.jc().add()})),s.Qb(1,"i",15),s.Vb(2,"span"),s.Hc(3),s.kc(4,"abpLocalization"),s.Ub(),s.Ub()}2&e&&(s.Cb(3),s.Ic(s.lc(4,1,"AbpIdentity::NewRole")))}const D=function(e){return{"width.px":e}};function K(e,t){1&e&&s.Qb(0,"col",21),2&e&&s.pc("ngStyle",s.tc(1,D,t.$implicit||void 0))}function B(e,t){if(1&e&&(s.Vb(0,"colgroup"),s.Fc(1,K,1,3,"col",20),s.Ub()),2&e){const e=s.jc().ngIf;s.Cb(1),s.pc("ngForOf",e)}}function $(e,t){if(1&e){const e=s.Wb();s.Vb(0,"tr"),s.Vb(1,"th"),s.Hc(2),s.kc(3,"abpLocalization"),s.Ub(),s.Vb(4,"th",22),s.hc("click",(function(){return s.zc(e),s.yc(8).sort("name")})),s.Hc(5),s.kc(6,"abpLocalization"),s.Vb(7,"abp-sort-order-icon",23,24),s.hc("selectedSortKeyChange",(function(t){return s.zc(e),s.jc(2).sortKey=t}))("orderChange",(function(t){return s.zc(e),s.jc(2).sortOrder=t})),s.Ub(),s.Ub(),s.Ub()}if(2&e){const e=s.jc(2);s.Cb(2),s.Ic(s.lc(3,4,"AbpIdentity::Actions")),s.Cb(3),s.Jc(" ",s.lc(6,6,"AbpIdentity::RoleName")," "),s.Cb(2),s.pc("selectedSortKey",e.sortKey)("order",e.sortOrder)}}function E(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",34),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).edit(t.id)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.Cb(1),s.Jc(" ",s.lc(2,1,"AbpIdentity::Edit")," "))}function q(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",34),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).openPermissionsModal(t.name)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.Cb(1),s.Jc(" ",s.lc(2,1,"AbpIdentity::Permissions")," "))}function Q(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",35),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).delete(t.id,t.name)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.pc("abpPermission","AbpIdentity.Roles.Delete"),s.Cb(1),s.Jc(" ",s.lc(2,2,"AbpIdentity::Delete")," "))}function W(e,t){1&e&&(s.Vb(0,"span",36),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()),2&e&&(s.Cb(1),s.Ic(s.lc(2,1,"AbpIdentity::DisplayName:IsDefault")))}function J(e,t){1&e&&(s.Vb(0,"span",37),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()),2&e&&(s.Cb(1),s.Ic(s.lc(2,1,"AbpIdentity::DisplayName:IsPublic")))}function _(e,t){if(1&e&&(s.Vb(0,"tr"),s.Vb(1,"td",25),s.Vb(2,"div",26),s.Vb(3,"button",27),s.Qb(4,"i",28),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub(),s.Vb(7,"div",29),s.Fc(8,E,3,3,"button",30),s.Fc(9,q,3,3,"button",30),s.Fc(10,Q,3,4,"button",31),s.Ub(),s.Ub(),s.Ub(),s.Vb(11,"td"),s.Hc(12),s.Fc(13,W,3,3,"span",32),s.Fc(14,J,3,3,"span",33),s.Ub(),s.Ub()),2&e){const e=t.$implicit;s.Cb(5),s.Jc("",s.lc(6,7,"AbpIdentity::Actions")," "),s.Cb(3),s.pc("abpPermission","AbpIdentity.Roles.Update"),s.Cb(1),s.pc("abpPermission","AbpIdentity.Roles.ManagePermissions"),s.Cb(1),s.pc("ngIf",!e.isStatic),s.Cb(2),s.Jc(" ",e.name,""),s.Cb(1),s.pc("ngIf",e.isDefault),s.Cb(1),s.pc("ngIf",e.isPublic)}}const Y=function(e,t){return{key:e,order:t}};function X(e,t){if(1&e){const e=s.Wb();s.Vb(0,"abp-table",16),s.hc("pageChange",(function(t){return s.zc(e),s.jc().onPageChange(t)})),s.kc(1,"async"),s.kc(2,"async"),s.Fc(3,B,2,1,"ng-template",null,17,s.Gc),s.Fc(5,$,9,8,"ng-template",null,18,s.Gc),s.Fc(7,_,15,9,"ng-template",null,19,s.Gc),s.Ub()}if(2&e){const e=s.yc(4),t=s.yc(6),n=s.yc(8),i=s.jc();s.pc("abpLoading",i.loading)("abpLoadingDelay",500)("abpTableSort",s.uc(14,Y,i.sortKey,i.sortOrder))("colgroupTemplate",e)("headerTemplate",t)("bodyTemplate",n)("value",s.lc(1,10,i.data$))("rows",i.pageQuery.maxResultCount)("totalRecords",s.lc(2,12,i.totalCount$))("scrollable",!0)}}function Z(e,t){if(1&e&&(s.Vb(0,"h3"),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()),2&e){const e=s.jc();s.Cb(1),s.Ic(s.lc(2,1,null!=e.selected&&e.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewRole"))}}function ee(e,t){if(1&e){const e=s.Wb();s.Vb(0,"form",38,39),s.hc("ngSubmit",(function(){return s.zc(e),s.jc().save()})),s.Vb(2,"div",40),s.Vb(3,"label",41),s.Hc(4),s.kc(5,"abpLocalization"),s.Ub(),s.Vb(6,"span"),s.Hc(7," * "),s.Ub(),s.Qb(8,"input",42),s.Ub(),s.Vb(9,"div",43),s.Qb(10,"input",44),s.Vb(11,"label",45),s.Hc(12),s.kc(13,"abpLocalization"),s.Ub(),s.Ub(),s.Vb(14,"div",43),s.Qb(15,"input",46),s.Vb(16,"label",47),s.Hc(17),s.kc(18,"abpLocalization"),s.Ub(),s.Ub(),s.Ub()}if(2&e){const e=s.jc();s.pc("formGroup",e.form),s.Cb(4),s.Ic(s.lc(5,4,"AbpIdentity::RoleName")),s.Cb(8),s.Ic(s.lc(13,6,"AbpIdentity::DisplayName:IsDefault")),s.Cb(5),s.Ic(s.lc(18,8,"AbpIdentity::DisplayName:IsPublic"))}}function te(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",48,49),s.Hc(2),s.kc(3,"abpLocalization"),s.Ub(),s.Vb(4,"abp-button",50),s.hc("click",(function(){return s.zc(e),s.jc().onClickSaveButton()})),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub()}if(2&e){const e=s.jc();s.Cb(2),s.Jc(" ",s.lc(3,3,"AbpIdentity::Cancel")," "),s.Cb(2),s.pc("disabled",null==e.form?null:e.form.invalid),s.Cb(1),s.Ic(s.lc(6,5,"AbpIdentity::Save"))}}function ne(e,t){if(1&e){const e=s.Wb();s.Vb(0,"abp-permission-management",51,52),s.hc("abpInit",(function(){return s.zc(e),(0,t.initTemplate)(s.yc(1))})),s.Ub()}}const ie=function(){return[150,0]},se=function(){return{value:"R"}},ce=function(e){return{value:e}},oe=function(e){return{value:e,twoWay:!0}},re=function(){return{value:!0}},ae=function(e,t,n,i){return{providerName:e,providerKey:t,visible:n,hideBadges:i}},le=function(e){return{visibleChange:e}},be=function(e,t){return{inputs:e,outputs:t,componentKey:"PermissionManagement.PermissionManagementComponent"}},de=["modalContent"];function pe(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",16),s.hc("click",(function(){return s.zc(e),s.jc().add()})),s.Qb(1,"i",17),s.Vb(2,"span"),s.Hc(3),s.kc(4,"abpLocalization"),s.Ub(),s.Ub()}2&e&&(s.Cb(3),s.Ic(s.lc(4,1,"AbpIdentity::NewUser")))}function ue(e,t){1&e&&s.Qb(0,"col",23),2&e&&s.pc("ngStyle",s.tc(1,D,t.$implicit||void 0))}function me(e,t){if(1&e&&(s.Vb(0,"colgroup"),s.Fc(1,ue,1,3,"col",22),s.Ub()),2&e){const e=s.jc().ngIf;s.Cb(1),s.pc("ngForOf",e)}}function he(e,t){if(1&e){const e=s.Wb();s.Vb(0,"tr"),s.Vb(1,"th"),s.Hc(2),s.kc(3,"abpLocalization"),s.Ub(),s.Vb(4,"th",24),s.hc("click",(function(){return s.zc(e),s.yc(8).sort("userName")})),s.Hc(5),s.kc(6,"abpLocalization"),s.Vb(7,"abp-sort-order-icon",25,26),s.hc("selectedSortKeyChange",(function(t){return s.zc(e),s.jc(2).sortKey=t}))("orderChange",(function(t){return s.zc(e),s.jc(2).sortOrder=t})),s.Ub(),s.Ub(),s.Vb(9,"th",24),s.hc("click",(function(){return s.zc(e),s.yc(8).sort("email")})),s.Hc(10),s.kc(11,"abpLocalization"),s.Vb(12,"abp-sort-order-icon",27),s.hc("selectedSortKeyChange",(function(t){return s.zc(e),s.jc(2).sortKey=t}))("orderChange",(function(t){return s.zc(e),s.jc(2).sortOrder=t})),s.Ub(),s.Ub(),s.Vb(13,"th",24),s.hc("click",(function(){return s.zc(e),s.yc(8).sort("phoneNumber")})),s.Hc(14),s.kc(15,"abpLocalization"),s.Vb(16,"abp-sort-order-icon",28),s.hc("selectedSortKeyChange",(function(t){return s.zc(e),s.jc(2).sortKey=t}))("orderChange",(function(t){return s.zc(e),s.jc(2).sortOrder=t})),s.Ub(),s.Ub(),s.Ub()}if(2&e){const e=s.jc(2);s.Cb(2),s.Ic(s.lc(3,10,"AbpIdentity::Actions")),s.Cb(3),s.Jc(" ",s.lc(6,12,"AbpIdentity::UserName")," "),s.Cb(2),s.pc("selectedSortKey",e.sortKey)("order",e.sortOrder),s.Cb(3),s.Jc(" ",s.lc(11,14,"AbpIdentity::EmailAddress")," "),s.Cb(2),s.pc("selectedSortKey",e.sortKey)("order",e.sortOrder),s.Cb(2),s.Jc(" ",s.lc(15,16,"AbpIdentity::PhoneNumber")," "),s.Cb(2),s.pc("selectedSortKey",e.sortKey)("order",e.sortOrder)}}function ye(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",35),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).edit(t.id)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.Cb(1),s.Jc(" ",s.lc(2,1,"AbpIdentity::Edit")," "))}function ge(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",35),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).openPermissionsModal(t.id)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.Cb(1),s.Jc(" ",s.lc(2,1,"AbpIdentity::Permissions")," "))}function fe(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",35),s.hc("click",(function(){s.zc(e);const t=s.jc().$implicit;return s.jc(2).delete(t.id,t.userName)})),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()}2&e&&(s.Cb(1),s.Jc(" ",s.lc(2,1,"AbpIdentity::Delete")," "))}function je(e,t){if(1&e&&(s.Vb(0,"tr"),s.Vb(1,"td",29),s.Vb(2,"div",30),s.Vb(3,"button",31),s.Qb(4,"i",32),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub(),s.Vb(7,"div",33),s.Fc(8,ye,3,3,"button",34),s.Fc(9,ge,3,3,"button",34),s.Fc(10,fe,3,3,"button",34),s.Ub(),s.Ub(),s.Ub(),s.Vb(11,"td"),s.Hc(12),s.Ub(),s.Vb(13,"td"),s.Hc(14),s.Ub(),s.Vb(15,"td"),s.Hc(16),s.Ub(),s.Ub()),2&e){const e=t.$implicit;s.Cb(5),s.Jc("",s.lc(6,7,"AbpIdentity::Actions")," "),s.Cb(3),s.pc("abpPermission","AbpIdentity.Users.Update"),s.Cb(1),s.pc("abpPermission","AbpIdentity.Users.ManagePermissions"),s.Cb(1),s.pc("abpPermission","AbpIdentity.Users.Delete"),s.Cb(2),s.Ic(e.userName),s.Cb(2),s.Ic(e.email),s.Cb(2),s.Ic(e.phoneNumber)}}function ve(e,t){if(1&e){const e=s.Wb();s.Vb(0,"abp-table",18),s.hc("pageChange",(function(t){return s.zc(e),s.jc().onPageChange(t)})),s.kc(1,"async"),s.kc(2,"async"),s.Fc(3,me,2,1,"ng-template",null,19,s.Gc),s.Fc(5,he,17,18,"ng-template",null,20,s.Gc),s.Fc(7,je,17,9,"ng-template",null,21,s.Gc),s.Ub()}if(2&e){const e=s.yc(4),t=s.yc(6),n=s.yc(8),i=s.jc();s.pc("abpLoading",i.loading)("abpLoadingDelay",500)("abpTableSort",s.uc(14,Y,i.sortKey,i.sortOrder))("colgroupTemplate",e)("headerTemplate",t)("bodyTemplate",n)("value",s.lc(1,10,i.data$))("rows",i.pageQuery.maxResultCount)("totalRecords",s.lc(2,12,i.totalCount$))("scrollable",!0)}}function Ce(e,t){if(1&e&&(s.Vb(0,"h3"),s.Hc(1),s.kc(2,"abpLocalization"),s.Ub()),2&e){const e=s.jc();s.Cb(1),s.Ic(s.lc(2,1,null!=e.selected&&e.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewUser"))}}function Ue(e,t){1&e&&(s.Vb(0,"div",29),s.Qb(1,"i",38),s.Ub())}function Oe(e,t){1&e&&(s.Vb(0,"span"),s.Hc(1," * "),s.Ub())}function Ie(e,t){if(1&e&&(s.Vb(0,"div",42),s.Vb(1,"div",43),s.Vb(2,"label",44),s.Hc(3),s.kc(4,"abpLocalization"),s.Ub(),s.Vb(5,"span"),s.Hc(6," * "),s.Ub(),s.Qb(7,"input",45),s.Ub(),s.Vb(8,"div",43),s.Vb(9,"label",46),s.Hc(10),s.kc(11,"abpLocalization"),s.Ub(),s.Qb(12,"input",47),s.Ub(),s.Vb(13,"div",43),s.Vb(14,"label",48),s.Hc(15),s.kc(16,"abpLocalization"),s.Ub(),s.Qb(17,"input",49),s.Ub(),s.Vb(18,"div",43),s.Vb(19,"label",50),s.Hc(20),s.kc(21,"abpLocalization"),s.Ub(),s.Fc(22,Oe,2,0,"span",51),s.Qb(23,"input",52),s.Ub(),s.Vb(24,"div",43),s.Vb(25,"label",53),s.Hc(26),s.kc(27,"abpLocalization"),s.Ub(),s.Vb(28,"span"),s.Hc(29," * "),s.Ub(),s.Qb(30,"input",54),s.Ub(),s.Vb(31,"div",43),s.Vb(32,"label",55),s.Hc(33),s.kc(34,"abpLocalization"),s.Ub(),s.Qb(35,"input",56),s.Ub(),s.Vb(36,"div",57),s.Qb(37,"input",58),s.Vb(38,"label",59),s.Hc(39),s.kc(40,"abpLocalization"),s.Ub(),s.Ub(),s.Vb(41,"div",57),s.Qb(42,"input",60),s.Vb(43,"label",61),s.Hc(44),s.kc(45,"abpLocalization"),s.Ub(),s.Ub(),s.Ub()),2&e){const e=s.jc(3);s.Cb(3),s.Ic(s.lc(4,9,"AbpIdentity::UserName")),s.Cb(7),s.Ic(s.lc(11,11,"AbpIdentity::DisplayName:Name")),s.Cb(5),s.Ic(s.lc(16,13,"AbpIdentity::DisplayName:Surname")),s.Cb(5),s.Ic(s.lc(21,15,"AbpIdentity::Password")),s.Cb(2),s.pc("ngIf",!e.selected.userName),s.Cb(4),s.Ic(s.lc(27,17,"AbpIdentity::EmailAddress")),s.Cb(7),s.Ic(s.lc(34,19,"AbpIdentity::PhoneNumber")),s.Cb(6),s.Ic(s.lc(40,21,"AbpIdentity::DisplayName:LockoutEnabled")),s.Cb(5),s.Ic(s.lc(45,23,"AbpIdentity::DisplayName:TwoFactorEnabled"))}}function ke(e,t){if(1&e&&(s.Vb(0,"div",57),s.Qb(1,"input",63),s.Vb(2,"label",64),s.Hc(3),s.Ub(),s.Ub()),2&e){const e=t.$implicit,n=t.index,i=s.jc(4);s.Cb(1),s.pc("formControl",e.controls[i.roles[n].name]),s.Db("id","roles-"+n),s.Cb(1),s.Db("for","roles-"+n),s.Cb(1),s.Ic(i.roles[n].name)}}function Ve(e,t){if(1&e&&(s.Vb(0,"div",42),s.Fc(1,ke,4,4,"div",62),s.Ub()),2&e){const e=s.jc(3);s.Cb(1),s.pc("ngForOf",e.roleGroups)("ngForTrackBy",e.trackByFn)}}function we(e,t){if(1&e){const e=s.Wb();s.Vb(0,"form",39),s.hc("ngSubmit",(function(){return s.zc(e),s.jc(2).save()})),s.Vb(1,"ngb-tabset"),s.Vb(2,"ngb-tab",40),s.kc(3,"abpLocalization"),s.Fc(4,Ie,46,25,"ng-template",41),s.Ub(),s.Vb(5,"ngb-tab",40),s.kc(6,"abpLocalization"),s.Fc(7,Ve,2,2,"ng-template",41),s.Ub(),s.Ub(),s.Ub()}if(2&e){const e=s.jc(2);s.pc("formGroup",e.form),s.Cb(2),s.pc("title",s.lc(3,3,"AbpIdentity::UserInformations")),s.Cb(3),s.pc("title",s.lc(6,5,"AbpIdentity::Roles"))}}function Re(e,t){if(1&e&&(s.Fc(0,Ue,2,0,"ng-template",null,36,s.Gc),s.Fc(2,we,8,7,"form",37)),2&e){const e=s.yc(1),t=s.jc();s.Cb(2),s.pc("ngIf",t.form)("ngIfElse",e)}}function Pe(e,t){if(1&e){const e=s.Wb();s.Vb(0,"button",65,66),s.Hc(2),s.kc(3,"abpLocalization"),s.Ub(),s.Vb(4,"abp-button",67),s.hc("click",(function(){return s.zc(e),s.jc().save()})),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub()}if(2&e){const e=s.jc();s.Cb(2),s.Jc(" ",s.lc(3,3,"AbpIdentity::Cancel")," "),s.Cb(2),s.pc("disabled",null==e.form?null:e.form.invalid),s.Cb(1),s.Ic(s.lc(6,5,"AbpIdentity::Save"))}}function Se(e,t){if(1&e){const e=s.Wb();s.Vb(0,"abp-permission-management",68,69),s.hc("abpInit",(function(){return s.zc(e),(0,t.initTemplate)(s.yc(1))})),s.Ub()}}const Fe=function(){return[150,250,250,250]},Ae=function(){return{value:"U"}},Ge=function(e,t,n){return{providerName:e,providerKey:t,visible:n}};let Te=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Get Roles",e})(),Ne=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Get Role By Id",e})(),Le=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Delete Role",e})(),ze=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Create Role",e})(),xe=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Update Role",e})(),Me=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Get Users",e})(),He=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Get User By Id",e})(),De=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Delete User",e})(),Ke=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Create User",e})(),Be=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Update User",e})(),$e=(()=>{class e{constructor(e){this.payload=e}}return e.type="[Identity] Get User Roles",e})(),Ee=(()=>{class e{constructor(e){this.rest=e}getRoles(e={}){return this.rest.request({method:"GET",url:"/api/identity/roles",params:e})}getAllRoles(){return this.rest.request({method:"GET",url:"/api/identity/roles/all"})}getRoleById(e){return this.rest.request({method:"GET",url:`/api/identity/roles/${e}`})}deleteRole(e){return this.rest.request({method:"DELETE",url:`/api/identity/roles/${e}`})}createRole(e){return this.rest.request({method:"POST",url:"/api/identity/roles",body:e})}updateRole(e){const t=`/api/identity/roles/${e.id}`;return delete e.id,this.rest.request({method:"PUT",url:t,body:e})}getUsers(e={}){return this.rest.request({method:"GET",url:"/api/identity/users",params:e})}getUserById(e){return this.rest.request({method:"GET",url:`/api/identity/users/${e}`})}getUserRoles(e){return this.rest.request({method:"GET",url:`/api/identity/users/${e}/roles`})}deleteUser(e){return this.rest.request({method:"DELETE",url:`/api/identity/users/${e}`})}createUser(e){return this.rest.request({method:"POST",url:"/api/identity/users",body:e})}updateUser(e){const t=`/api/identity/users/${e.id}`;return delete e.id,this.rest.request({method:"PUT",url:t,body:e})}}return e.\u0275fac=function(t){return new(t||e)(s.dc(i.x))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e.ngInjectableDef=Object(s.Lb)({factory:function(){return new e(Object(s.dc)(i.x))},token:e,providedIn:"root"}),e})(),qe=(()=>{let e=class{constructor(e){this.identityService=e}static getRoles({roles:e}){return e.items||[]}static getRolesTotalCount({roles:e}){return e.totalCount||0}static getUsers({users:e}){return e.items||[]}static getUsersTotalCount({users:e}){return e.totalCount||0}getRoles({patchState:e},{payload:t}){return this.identityService.getRoles(t).pipe(Object(b.a)(t=>e({roles:t})))}getRole({patchState:e},{payload:t}){return this.identityService.getRoleById(t).pipe(Object(b.a)(t=>e({selectedRole:t})))}deleteRole(e,{payload:t}){return this.identityService.deleteRole(t)}addRole(e,{payload:t}){return this.identityService.createRole(t)}updateRole({getState:e},{payload:t}){return this.identityService.updateRole(Object.assign({},e().selectedRole,t))}getUsers({patchState:e},{payload:t}){return this.identityService.getUsers(t).pipe(Object(b.a)(t=>e({users:t})))}getUser({patchState:e},{payload:t}){return this.identityService.getUserById(t).pipe(Object(b.a)(t=>e({selectedUser:t})))}deleteUser(e,{payload:t}){return this.identityService.deleteUser(t)}addUser(e,{payload:t}){return this.identityService.createUser(t)}updateUser({getState:e},{payload:t}){return this.identityService.updateUser(Object.assign({},e().selectedUser,t))}getUserRoles({patchState:e},{payload:t}){return this.identityService.getUserRoles(t).pipe(Object(d.a)("items"),Object(b.a)(t=>e({selectedUserRoles:t})))}};return e.\u0275fac=function(t){return new(t||e)(s.dc(Ee))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac}),Object(o.b)([Object(c.a)(Te),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Te]),Object(o.c)("design:returntype",void 0)],e.prototype,"getRoles",null),Object(o.b)([Object(c.a)(Ne),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Ne]),Object(o.c)("design:returntype",void 0)],e.prototype,"getRole",null),Object(o.b)([Object(c.a)(Le),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Ne]),Object(o.c)("design:returntype",void 0)],e.prototype,"deleteRole",null),Object(o.b)([Object(c.a)(ze),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,ze]),Object(o.c)("design:returntype",void 0)],e.prototype,"addRole",null),Object(o.b)([Object(c.a)(xe),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,xe]),Object(o.c)("design:returntype",void 0)],e.prototype,"updateRole",null),Object(o.b)([Object(c.a)(Me),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Me]),Object(o.c)("design:returntype",void 0)],e.prototype,"getUsers",null),Object(o.b)([Object(c.a)(He),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,He]),Object(o.c)("design:returntype",void 0)],e.prototype,"getUser",null),Object(o.b)([Object(c.a)(De),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,He]),Object(o.c)("design:returntype",void 0)],e.prototype,"deleteUser",null),Object(o.b)([Object(c.a)(Ke),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Ke]),Object(o.c)("design:returntype",void 0)],e.prototype,"addUser",null),Object(o.b)([Object(c.a)(Be),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,Be]),Object(o.c)("design:returntype",void 0)],e.prototype,"updateUser",null),Object(o.b)([Object(c.a)($e),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object,$e]),Object(o.c)("design:returntype",void 0)],e.prototype,"getUserRoles",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",Array)],e,"getRoles",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",Number)],e,"getRolesTotalCount",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",Array)],e,"getUsers",null),Object(o.b)([Object(c.g)(),Object(o.c)("design:type",Function),Object(o.c)("design:paramtypes",[Object]),Object(o.c)("design:returntype",Number)],e,"getUsersTotalCount",null),e=Object(o.b)([Object(c.h)({name:"IdentityState",defaults:{roles:{},selectedRole:{},users:{},selectedUser:{}}})],e),e})(),Qe=(()=>{class e{constructor(e,t,n){this.confirmationService=e,this.fb=t,this.store=n,this.visiblePermissions=!1,this.pageQuery={maxResultCount:10},this.loading=!1,this.modalBusy=!1,this.sortOrder="",this.sortKey="",this.onVisiblePermissionChange=e=>{this.visiblePermissions=e}}ngOnInit(){this.get()}buildForm(){this.form=this.fb.group({name:new a.d({value:this.selected.name||"",disabled:this.selected.isStatic},[a.t.required,a.t.maxLength(256)]),isDefault:[this.selected.isDefault||!1],isPublic:[this.selected.isPublic||!1]})}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.openModal()}edit(e){this.store.dispatch(new Ne(e)).pipe(Object(d.a)("IdentityState","selectedRole")).subscribe(e=>{this.selected=e,this.openModal()})}save(){this.form.valid&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new xe(Object.assign({},this.selected,this.form.value,{id:this.selected.id})):new ze(this.form.value)).pipe(Object(p.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.get()}))}delete(e,t){this.confirmationService.warn("AbpIdentity::RoleDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[t]}).subscribe(t=>{t===r.m.Status.confirm&&this.store.dispatch(new Le(e)).subscribe(()=>this.get())})}onPageChange(e){this.pageQuery.skipCount=(e-1)*this.pageQuery.maxResultCount,this.get()}get(){this.loading=!0,this.store.dispatch(new Te(this.pageQuery)).pipe(Object(p.a)(()=>this.loading=!1)).subscribe()}onClickSaveButton(){this.formRef.nativeElement.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))}openPermissionsModal(e){this.providerKey=e,setTimeout(()=>{this.visiblePermissions=!0},0)}}return e.\u0275fac=function(t){return new(t||e)(s.Pb(r.e),s.Pb(a.c),s.Pb(c.j))},e.\u0275cmp=s.Jb({type:e,selectors:[["abp-roles"]],viewQuery:function(e,t){var n;1&e&&s.Lc(M,!0,s.n),2&e&&s.xc(n=s.ic())&&(t.formRef=n.first)},decls:19,vars:25,consts:[["id","identity-roles-wrapper",1,"card"],[1,"card-header"],[1,"row"],[1,"col","col-md-6"],[1,"card-title"],[1,"text-right","col","col-md-6"],["id","create-role","class","btn btn-primary","type","button",3,"click",4,"abpPermission"],[1,"card-body"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange",4,"ngIf"],["size","md",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"abpInit",4,"abpReplaceableTemplate"],["id","create-role","type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","mr-1"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange"],["tableColGroup",""],["tableHeader",""],["tableBody",""],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[3,"click"],["sortKey","name",3,"selectedSortKey","order","selectedSortKeyChange","orderChange"],["sortOrderIcon",""],[1,"text-center"],["ngbDropdown","","container","body",1,"d-inline-block"],["data-toggle","dropdown","aria-haspopup","true","ngbDropdownToggle","",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog","mr-1"],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"click",4,"abpPermission"],["ngbDropdownItem","",3,"abpPermission","click",4,"ngIf"],["class","badge badge-pill badge-success ml-1",4,"ngIf"],["class","badge badge-pill badge-info ml-1",4,"ngIf"],["ngbDropdownItem","",3,"click"],["ngbDropdownItem","",3,"abpPermission","click"],[1,"badge","badge-pill","badge-success","ml-1"],[1,"badge","badge-pill","badge-info","ml-1"],["validateOnSubmit","",3,"formGroup","ngSubmit"],["formRef",""],[1,"form-group"],["for","role-name"],["autofocus","","type","text","id","role-name","formControlName","name",1,"form-control"],[1,"custom-checkbox","custom-control","mb-2"],["type","checkbox","id","role-is-default","formControlName","isDefault",1,"custom-control-input"],["for","role-is-default",1,"custom-control-label"],["type","checkbox","id","role-is-public","formControlName","isPublic",1,"custom-control-input"],["for","role-is-public",1,"custom-control-label"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],[3,"abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(e,t){1&e&&(s.Vb(0,"div",0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Vb(3,"div",3),s.Vb(4,"h5",4),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub(),s.Ub(),s.Vb(7,"div",5),s.Fc(8,H,5,3,"button",6),s.Ub(),s.Ub(),s.Ub(),s.Vb(9,"div",7),s.Fc(10,X,9,17,"abp-table",8),s.Ub(),s.Ub(),s.Vb(11,"abp-modal",9),s.hc("visibleChange",(function(e){return t.isModalVisible=e})),s.Fc(12,Z,3,3,"ng-template",null,10,s.Gc),s.Fc(14,ee,19,10,"ng-template",null,11,s.Gc),s.Fc(16,te,7,7,"ng-template",null,12,s.Gc),s.Ub(),s.Fc(18,ne,2,0,"abp-permission-management",13)),2&e&&(s.Cb(5),s.Ic(s.lc(6,6,"AbpIdentity::Roles")),s.Cb(3),s.pc("abpPermission","AbpIdentity.Roles.Create"),s.Cb(2),s.pc("ngIf",s.sc(8,ie)),s.Cb(1),s.pc("visible",t.isModalVisible)("busy",t.modalBusy),s.Cb(7),s.pc("abpReplaceableTemplate",s.uc(22,be,s.wc(15,ae,s.sc(9,se),s.tc(10,ce,t.providerKey),s.tc(12,oe,t.visiblePermissions),s.sc(14,re)),s.tc(20,le,t.onVisiblePermissionChange))))},directives:[i.r,v.n,r.h,i.v,r.j,r.g,r.k,v.m,v.o,r.i,f.c,f.g,f.e,f.d,a.v,a.o,i.j,a.h,y.d,a.b,i.c,a.n,a.f,y.b,a.a,r.b,T,i.m],pipes:[i.o,v.b],encapsulation:2}),Object(o.b)([Object(c.f)(qe.getRoles),Object(o.c)("design:type",l.a)],e.prototype,"data$",void 0),Object(o.b)([Object(c.f)(qe.getRolesTotalCount),Object(o.c)("design:type",l.a)],e.prototype,"totalCount$",void 0),e})(),We=(()=>{class e{constructor(e,t,n,i){this.confirmationService=e,this.fb=t,this.store=n,this.identityService=i,this.visiblePermissions=!1,this.pageQuery={maxResultCount:10},this.loading=!1,this.modalBusy=!1,this.sortOrder="",this.sortKey="",this.passwordRulesArr=[],this.requiredPasswordLength=1,this.trackByFn=(e,t)=>Object.keys(t)[0]||e,this.onVisiblePermissionChange=e=>{this.visiblePermissions=e}}get roleGroups(){return Object(g.a)(()=>this.form.get("roleNames").controls,[])}ngOnInit(){this.get();const e=this.store.selectSnapshot(i.e.getSettings("Identity.Password"));"true"===(e["Abp.Identity.Password.RequireDigit"]||"").toLowerCase()&&this.passwordRulesArr.push("number"),"true"===(e["Abp.Identity.Password.RequireLowercase"]||"").toLowerCase()&&this.passwordRulesArr.push("small"),"true"===(e["Abp.Identity.Password.RequireUppercase"]||"").toLowerCase()&&this.passwordRulesArr.push("capital"),"true"===(e["Abp.Identity.Password.RequireNonAlphanumeric"]||"").toLowerCase()&&this.passwordRulesArr.push("special"),Number.isInteger(+e["Abp.Identity.Password.RequiredLength"])&&(this.requiredPasswordLength=+e["Abp.Identity.Password.RequiredLength"])}onSearch(e){this.pageQuery.filter=e,this.get()}buildForm(){this.identityService.getAllRoles().subscribe(({items:e})=>{this.roles=e,this.form=this.fb.group({userName:[this.selected.userName||"",[a.t.required,a.t.maxLength(256)]],email:[this.selected.email||"",[a.t.required,a.t.email,a.t.maxLength(256)]],name:[this.selected.name||"",[a.t.maxLength(64)]],surname:[this.selected.surname||"",[a.t.maxLength(64)]],phoneNumber:[this.selected.phoneNumber||"",[a.t.maxLength(16)]],lockoutEnabled:[this.selected.lockoutEnabled||!this.selected.id],twoFactorEnabled:[this.selected.twoFactorEnabled||!this.selected.id],roleNames:this.fb.array(this.roles.map(e=>this.fb.group({[e.name]:[this.selected.id?!!Object(g.a)(()=>this.selectedUserRoles.find(t=>t.id===e.id)):e.isDefault]})))});const t=[Object(y.i)(this.passwordRulesArr),a.t.minLength(this.requiredPasswordLength),a.t.maxLength(128)];this.form.addControl("password",new a.d("",[...t])),this.selected.userName||(this.form.get("password").setValidators([...t,a.t.required]),this.form.get("password").updateValueAndValidity())})}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.selectedUserRoles=[],this.openModal()}edit(e){this.store.dispatch(new He(e)).pipe(Object(u.a)(()=>this.store.dispatch(new $e(e))),Object(d.a)("IdentityState"),Object(m.a)(1)).subscribe(e=>{this.selected=e.selectedUser,this.selectedUserRoles=e.selectedUserRoles||[],this.openModal()})}save(){if(!this.form.valid||this.modalBusy)return;this.modalBusy=!0;const{roleNames:e}=this.form.value,t=Object(g.a)(()=>e.filter(e=>!!e[Object.keys(e)[0]]).map(e=>Object.keys(e)[0]),[]);this.store.dispatch(this.selected.id?new Be(Object.assign({},this.selected,this.form.value,{id:this.selected.id,roleNames:t})):new Ke(Object.assign({},this.form.value,{roleNames:t}))).pipe(Object(p.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.get()})}delete(e,t){this.confirmationService.warn("AbpIdentity::UserDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[t]}).subscribe(t=>{t===r.c.Status.confirm&&this.store.dispatch(new De(e)).subscribe(()=>this.get())})}onPageChange(e){this.pageQuery.skipCount=(e-1)*this.pageQuery.maxResultCount,this.get()}get(){this.loading=!0,this.store.dispatch(new Me(this.pageQuery)).pipe(Object(p.a)(()=>this.loading=!1)).subscribe()}openPermissionsModal(e){this.providerKey=e,setTimeout(()=>{this.visiblePermissions=!0},0)}}return e.\u0275fac=function(t){return new(t||e)(s.Pb(r.e),s.Pb(a.c),s.Pb(c.j),s.Pb(Ee))},e.\u0275cmp=s.Jb({type:e,selectors:[["abp-users"]],viewQuery:function(e,t){var n;1&e&&s.Lc(de,!0),2&e&&s.xc(n=s.ic())&&(t.modalContent=n.first)},decls:23,vars:26,consts:[["id","identity-roles-wrapper",1,"card"],[1,"card-header"],[1,"row"],[1,"col","col-md-6"],[1,"card-title"],[1,"text-right","col","col-md-6"],["id","create-role","class","btn btn-primary","type","button",3,"click",4,"abpPermission"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter"],["type","search",1,"form-control","form-control-sm",3,"placeholder","input.debounce"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange",4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"abpInit",4,"abpReplaceableTemplate"],["id","create-role","type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","mr-1"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange"],["tableColGroup",""],["tableHeader",""],["tableBody",""],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[3,"click"],["sortKey","userName",3,"selectedSortKey","order","selectedSortKeyChange","orderChange"],["sortOrderIcon",""],["sortKey","email",3,"selectedSortKey","order","selectedSortKeyChange","orderChange"],["sortKey","phoneNumber",3,"selectedSortKey","order","selectedSortKeyChange","orderChange"],[1,"text-center"],["ngbDropdown","","container","body",1,"d-inline-block"],["data-toggle","dropdown","aria-haspopup","true","ngbDropdownToggle","",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog","mr-1"],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"click",4,"abpPermission"],["ngbDropdownItem","",3,"click"],["loaderRef",""],[3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[1,"fa","fa-pulse","fa-spinner"],[3,"formGroup","ngSubmit"],[3,"title"],["ngbTabContent",""],[1,"mt-2","fade-in-top"],[1,"form-group"],["for","user-name"],["type","text","id","user-name","formControlName","userName","autofocus","",1,"form-control"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control"],["for","surname"],["type","text","id","surname","formControlName","surname",1,"form-control"],["for","password"],[4,"ngIf"],["type","password","id","password","autocomplete","new-password","formControlName","password",1,"form-control"],["for","email"],["type","text","id","email","formControlName","email",1,"form-control"],["for","phone-number"],["type","text","id","phone-number","formControlName","phoneNumber",1,"form-control"],[1,"custom-checkbox","custom-control","mb-2"],["type","checkbox","id","lockout-checkbox","formControlName","lockoutEnabled",1,"custom-control-input"],["for","lockout-checkbox",1,"custom-control-label"],["type","checkbox","id","two-factor-checkbox","formControlName","twoFactorEnabled",1,"custom-control-input"],["for","two-factor-checkbox",1,"custom-control-label"],["class","custom-checkbox custom-control mb-2",4,"ngFor","ngForOf","ngForTrackBy"],["type","checkbox",1,"custom-control-input",3,"formControl"],[1,"custom-control-label"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],[3,"abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(e,t){1&e&&(s.Vb(0,"div",0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Vb(3,"div",3),s.Vb(4,"h5",4),s.Hc(5),s.kc(6,"abpLocalization"),s.Ub(),s.Ub(),s.Vb(7,"div",5),s.Fc(8,pe,5,3,"button",6),s.Ub(),s.Ub(),s.Ub(),s.Vb(9,"div",7),s.Vb(10,"div",8),s.Vb(11,"label"),s.Vb(12,"input",9),s.hc("input.debounce",(function(e){return t.onSearch(e.target.value)})),s.kc(13,"abpLocalization"),s.Ub(),s.Ub(),s.Ub(),s.Fc(14,ve,9,17,"abp-table",10),s.Ub(),s.Ub(),s.Vb(15,"abp-modal",11),s.hc("visibleChange",(function(e){return t.isModalVisible=e}))("disappear",(function(){return t.form=null})),s.Fc(16,Ce,3,3,"ng-template",null,12,s.Gc),s.Fc(18,Re,3,2,"ng-template",null,13,s.Gc),s.Fc(20,Pe,7,7,"ng-template",null,14,s.Gc),s.Ub(),s.Fc(22,Se,2,0,"abp-permission-management",15)),2&e&&(s.Cb(5),s.Ic(s.lc(6,7,"AbpIdentity::Users")),s.Cb(3),s.pc("abpPermission","AbpIdentity.Users.Create"),s.Cb(4),s.pc("placeholder",s.lc(13,9,"AbpUi::PagerSearch")),s.Cb(2),s.pc("ngIf",s.sc(11,Fe)),s.Cb(1),s.pc("visible",t.isModalVisible)("busy",t.modalBusy),s.Cb(7),s.pc("abpReplaceableTemplate",s.uc(23,be,s.vc(17,Ge,s.sc(12,Ae),s.tc(13,ce,t.providerKey),s.tc(15,oe,t.visiblePermissions)),s.tc(21,le,t.onVisiblePermissionChange))))},directives:[i.r,i.K,v.n,r.h,i.v,r.j,r.g,r.k,v.m,v.o,r.i,f.c,f.g,f.e,f.d,a.v,a.o,i.j,a.h,y.d,f.m,f.k,f.l,a.b,a.n,a.f,y.b,i.c,a.a,a.e,r.b,T,i.m],pipes:[i.o,v.b],encapsulation:2}),Object(o.b)([Object(c.f)(qe.getUsers),Object(o.c)("design:type",l.a)],e.prototype,"data$",void 0),Object(o.b)([Object(c.f)(qe.getUsersTotalCount),Object(o.c)("design:type",l.a)],e.prototype,"totalCount$",void 0),e})();const Je=[{path:"",redirectTo:"roles",pathMatch:"full"},{path:"",component:i.g,canActivate:[i.a,i.s],children:[{path:"roles",component:i.u,data:{requiredPolicy:"AbpIdentity.Roles",replaceableComponent:{key:"Identity.RolesComponent",defaultComponent:Qe}}},{path:"users",component:i.u,data:{requiredPolicy:"AbpIdentity.Users",replaceableComponent:{key:"Identity.UsersComponent",defaultComponent:We}}}]}];let _e=(()=>{class e{}return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[h.j.forChild(Je),i.f],h.j]}),e})(),Ye=(()=>{class e{}return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[c.e.forFeature([qe]),i.f,_e,f.n,r.l,f.f,z,y.a]]}),e})();var Xe;!function(e){e.State=function(){},e.RoleSaveRequest=function(){},e.RoleItem=function(){},e.UserItem=function(){},e.User=function(){},e.UserSaveRequest=function(){}}(Xe||(Xe={}));let Ze=(()=>{class e{constructor(e){this.store=e}getRoles(){return this.store.selectSnapshot(qe.getRoles)}getRolesTotalCount(){return this.store.selectSnapshot(qe.getRolesTotalCount)}getUsers(){return this.store.selectSnapshot(qe.getUsers)}getUsersTotalCount(){return this.store.selectSnapshot(qe.getUsersTotalCount)}dispatchGetRoles(...e){return this.store.dispatch(new Te(...e))}dispatchGetRoleById(...e){return this.store.dispatch(new Ne(...e))}dispatchDeleteRole(...e){return this.store.dispatch(new Le(...e))}dispatchCreateRole(...e){return this.store.dispatch(new ze(...e))}dispatchUpdateRole(...e){return this.store.dispatch(new xe(...e))}dispatchGetUsers(...e){return this.store.dispatch(new Me(...e))}dispatchGetUserById(...e){return this.store.dispatch(new He(...e))}dispatchDeleteUser(...e){return this.store.dispatch(new De(...e))}dispatchCreateUser(...e){return this.store.dispatch(new Ke(...e))}dispatchUpdateUser(...e){return this.store.dispatch(new Be(...e))}dispatchGetUserRoles(...e){return this.store.dispatch(new $e(...e))}}return e.\u0275fac=function(t){return new(t||e)(s.dc(c.j))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e.ngInjectableDef=Object(s.Lb)({factory:function(){return new e(Object(s.dc)(c.j))},token:e,providedIn:"root"}),e})()}}]);