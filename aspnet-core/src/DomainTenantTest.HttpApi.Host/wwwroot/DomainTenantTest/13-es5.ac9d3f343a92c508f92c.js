function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"6MLJ":function(e,t,n){"use strict";n.r(t);var a=n("HmNo"),i=n("1REP"),c=n("fXoL"),r=n("1kSV"),o=n("AcyG"),u=n("mrSG"),s=n("3Pt+"),l=n("HDdC"),b=n("vkgz"),d=n("wO+i"),p=n("eIep"),f=n("IzEk"),m=n("nYR2"),g=n("tyNb"),h=n("ofXK");function v(e,t){1&e&&(c.Vb(0,"h3"),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()),2&e&&(c.Cb(1),c.Ic(c.lc(2,1,"AbpFeatureManagement::Features")))}function y(e,t){if(1&e&&(c.Vb(0,"div",11),c.Qb(1,"input",12),c.Ub()),2&e){var n=c.jc().index;c.Cb(1),c.pc("formControlName",n)}}function C(e,t){if(1&e&&(c.Vb(0,"div",11),c.Qb(1,"input",13),c.Ub()),2&e){var n=c.jc().index;c.Cb(1),c.pc("formControlName",n)}}function T(e,t){if(1&e&&(c.Vb(0,"div",8),c.Vb(1,"div",9),c.Hc(2),c.Ub(),c.Fc(3,y,2,1,"div",10),c.Fc(4,C,2,1,"div",10),c.Ub()),2&e){var n=t.$implicit;c.pc("ngSwitch",n.valueType.name),c.Cb(2),c.Ic(n.name),c.Cb(1),c.pc("ngSwitchCase","ToggleStringValueType"),c.Cb(1),c.pc("ngSwitchCase","FreeTextStringValueType")}}function j(e,t){1&e&&(c.Vb(0,"div"),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()),2&e&&(c.Cb(1),c.Jc(" ",c.lc(2,1,"AbpFeatureManagement::NoFeatureFoundMessage")," "))}function k(e,t){if(1&e){var n=c.Wb();c.Vb(0,"form",5),c.hc("ngSubmit",(function(){return c.zc(n),c.jc(2).save()})),c.Fc(1,T,5,4,"div",6),c.kc(2,"async"),c.Fc(3,j,3,3,"div",7),c.kc(4,"async"),c.Ub()}if(2&e){var a,i=c.jc(2),r=!(null!=(a=c.lc(4,5,i.features$))&&a.length);c.pc("formGroup",i.form),c.Cb(1),c.pc("ngForOf",c.lc(2,3,i.features$)),c.Cb(2),c.pc("ngIf",r)}}function S(e,t){if(1&e&&c.Fc(0,k,5,7,"form",4),2&e){var n=c.jc();c.pc("ngIf",n.form)}}function O(e,t){if(1&e){var n=c.Wb();c.Tb(0),c.Vb(1,"button",14,15),c.Hc(3),c.kc(4,"abpLocalization"),c.Ub(),c.Vb(5,"abp-button",16),c.hc("click",(function(){return c.zc(n),c.jc(2).save()})),c.Hc(6),c.kc(7,"abpLocalization"),c.Ub(),c.Sb()}if(2&e){var a=c.jc(2);c.Cb(3),c.Jc(" ",c.lc(4,3,"AbpFeatureManagement::Cancel")," "),c.Cb(2),c.pc("disabled",(null==a.form?null:a.form.invalid)||a.modalBusy),c.Cb(1),c.Jc(" ",c.lc(7,5,"AbpFeatureManagement::Save")," ")}}function F(e,t){if(1&e&&(c.Fc(0,O,8,7,"ng-container",7),c.kc(1,"async")),2&e){var n,a=c.jc(),i=null==(n=c.lc(1,1,a.features$))?null:n.length;c.pc("ngIf",i)}}var M,w,U,V,I=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[FeatureManagement] Get Features",e}(),A=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[FeatureManagement] Update Features",e}(),D=((V=function(){function e(t,n){_classCallCheck(this,e),this.rest=t,this.store=n}return _createClass(e,[{key:"getFeatures",value:function(e){return this.rest.request({method:"GET",url:"/api/abp/features",params:e})}},{key:"updateFeatures",value:function(e){var t=e.features,n=e.providerKey,a=e.providerName;return this.rest.request({method:"PUT",url:"/api/abp/features",body:{features:t},params:{providerKey:n,providerName:a}})}}]),e}()).\u0275fac=function(e){return new(e||V)(c.dc(a.x),c.dc(o.j))},V.\u0275prov=c.Lb({token:V,factory:V.\u0275fac,providedIn:"root"}),V.ngInjectableDef=Object(c.Lb)({factory:function(){return new V(Object(c.dc)(a.x),Object(c.dc)(o.j))},token:V,providedIn:"root"}),V),_=((U=function(){function e(t){_classCallCheck(this,e),this.featureManagementService=t}return _createClass(e,[{key:"getFeatures",value:function(e,t){var n=e.patchState,a=t.payload;return this.featureManagementService.getFeatures(a).pipe(Object(b.a)((function(e){var t=e.features;return n({features:t})})))}},{key:"updateFeatures",value:function(e,t){var n=t.payload;return this.featureManagementService.updateFeatures(n)}}],[{key:"getFeatures",value:function(e){return e.features||[]}}]),e}()).\u0275fac=function(e){return new(e||U)(c.dc(D))},U.\u0275prov=c.Lb({token:U,factory:U.\u0275fac}),Object(u.b)([Object(o.a)(I),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,I]),Object(u.c)("design:returntype",void 0)],U.prototype,"getFeatures",null),Object(u.b)([Object(o.a)(A),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,A]),Object(u.c)("design:returntype",void 0)],U.prototype,"updateFeatures",null),Object(u.b)([Object(o.g)(),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object]),Object(u.c)("design:returntype",void 0)],U,"getFeatures",null),U=Object(u.b)([Object(o.h)({name:"FeatureManagementState",defaults:{features:{}}})],U)),L=((w=function(){function e(t){_classCallCheck(this,e),this.store=t,this.visibleChange=new c.p,this.modalBusy=!1}return _createClass(e,[{key:"openModal",value:function(){if(!this.providerKey||!this.providerName)throw new Error("Provider Key and Provider Name are required.");this.getFeatures()}},{key:"getFeatures",value:function(){var e=this;this.store.dispatch(new I({providerKey:this.providerKey,providerName:this.providerName})).pipe(Object(d.a)("FeatureManagementState","features")).subscribe((function(t){e.buildForm(t)}))}},{key:"buildForm",value:function(e){for(var t={},n=0;n<e.length;n++)t[n]=new s.d("false"===e[n].value?null:e[n].value);this.form=new s.g(t)}},{key:"save",value:function(){var e=this;if(!this.modalBusy){this.modalBusy=!0;var t=this.store.selectSnapshot(_.getFeatures);t=t.map((function(t,n){return{name:t.name,value:e.form.value[n]&&"false"!==e.form.value[n]?e.form.value[n]:null}})),this.store.dispatch(new A({providerKey:this.providerKey,providerName:this.providerName,features:t})).pipe(Object(m.a)((function(){return e.modalBusy=!1}))).subscribe((function(){e.visible=!1}))}}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.visibleChange.emit(e),e&&this.openModal()}}]),e}()).\u0275fac=function(e){return new(e||w)(c.Pb(o.j))},w.\u0275cmp=c.Jb({type:w,selectors:[["abp-feature-management"]],inputs:{visible:"visible",providerKey:"providerKey",providerName:"providerName"},outputs:{visibleChange:"visibleChange"},exportAs:["abpFeatureManagement"],decls:7,vars:2,consts:[["size","md",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["validateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["validateOnSubmit","",3,"formGroup","ngSubmit"],["class","row my-3",3,"ngSwitch",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row","my-3",3,"ngSwitch"],[1,"col-4"],["class","col-8",4,"ngSwitchCase"],[1,"col-8"],["type","checkbox","name","feature.name",3,"formControlName"],["type","text","name","feature.name",3,"formControlName"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"]],template:function(e,t){1&e&&(c.Vb(0,"abp-modal",0),c.hc("visibleChange",(function(e){return t.visible=e})),c.Fc(1,v,3,3,"ng-template",null,1,c.Gc),c.Fc(3,S,1,1,"ng-template",null,2,c.Gc),c.Fc(5,F,2,3,"ng-template",null,3,c.Gc),c.Ub()),2&e&&c.pc("visible",t.visible)("busy",t.modalBusy)},directives:[i.h,h.n,s.v,s.o,a.j,s.h,h.m,h.p,h.q,s.a,s.n,s.f,s.b,i.b],pipes:[a.o,h.b],encapsulation:2}),Object(u.b)([Object(o.f)(_.getFeatures),Object(u.c)("design:type",l.a)],w.prototype,"features$",void 0),w),z=((M=function e(){_classCallCheck(this,e)}).\u0275mod=c.Nb({type:M}),M.\u0275inj=c.Mb({factory:function(e){return new(e||M)},imports:[[a.f,i.l,o.e.forFeature([_])]]}),M),P=n("iWZL");n.d(t,"CreateTenant",(function(){return ke})),n.d(t,"DeleteTenant",(function(){return Oe})),n.d(t,"GetTenantById",(function(){return je})),n.d(t,"GetTenants",(function(){return Te})),n.d(t,"TenantManagementModule",(function(){return Ie})),n.d(t,"TenantManagementService",(function(){return Fe})),n.d(t,"TenantManagementState",(function(){return Me})),n.d(t,"TenantManagementStateService",(function(){return De})),n.d(t,"TenantsComponent",(function(){return we})),n.d(t,"UpdateTenant",(function(){return Se})),n.d(t,"\u0275a",(function(){return we})),n.d(t,"\u0275b",(function(){return Me})),n.d(t,"\u0275c",(function(){return Fe})),n.d(t,"\u0275d",(function(){return Te})),n.d(t,"\u0275e",(function(){return je})),n.d(t,"\u0275f",(function(){return ke})),n.d(t,"\u0275g",(function(){return Se})),n.d(t,"\u0275h",(function(){return Oe})),n.d(t,"\u0275j",(function(){return Ve}));var N=["tenantModalTemplate"],G=["connectionStringModalTemplate"];function K(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",18),c.hc("click",(function(){return c.zc(n),c.jc().addTenant()})),c.Qb(1,"i",19),c.Vb(2,"span"),c.Hc(3),c.kc(4,"abpLocalization"),c.Ub(),c.Ub()}2&e&&(c.Cb(3),c.Ic(c.lc(4,1,"AbpTenantManagement::NewTenant")))}var B=function(e){return{"width.px":e}};function H(e,t){1&e&&c.Qb(0,"col",25),2&e&&c.pc("ngStyle",c.tc(1,B,t.$implicit||void 0))}function x(e,t){if(1&e&&(c.Vb(0,"colgroup"),c.Fc(1,H,1,3,"col",24),c.Ub()),2&e){var n=c.jc().ngIf;c.Cb(1),c.pc("ngForOf",n)}}function E(e,t){if(1&e){var n=c.Wb();c.Vb(0,"tr"),c.Vb(1,"th"),c.Hc(2),c.kc(3,"abpLocalization"),c.Ub(),c.Vb(4,"th",26),c.hc("click",(function(){return c.zc(n),c.yc(8).sort("name")})),c.Hc(5),c.kc(6,"abpLocalization"),c.Vb(7,"abp-sort-order-icon",27,28),c.hc("selectedSortKeyChange",(function(e){return c.zc(n),c.jc(2).sortKey=e}))("orderChange",(function(e){return c.zc(n),c.jc(2).sortOrder=e})),c.Ub(),c.Ub(),c.Ub()}if(2&e){var a=c.jc(2);c.Cb(2),c.Ic(c.lc(3,4,"AbpTenantManagement::Actions")),c.Cb(3),c.Jc(" ",c.lc(6,6,"AbpTenantManagement::TenantName")," "),c.Cb(2),c.pc("selectedSortKey",a.sortKey)("order",a.sortOrder)}}function R(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",35),c.hc("click",(function(){c.zc(n);var e=c.jc().$implicit;return c.jc(2).editTenant(e.id)})),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()}2&e&&(c.Cb(1),c.Jc(" ",c.lc(2,1,"AbpTenantManagement::Edit")," "))}function q(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",35),c.hc("click",(function(){c.zc(n);var e=c.jc().$implicit;return c.jc(2).onEditConnectionString(e.id)})),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()}2&e&&(c.Cb(1),c.Jc(" ",c.lc(2,1,"AbpTenantManagement::Permission:ManageConnectionStrings")," "))}function Q(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",35),c.hc("click",(function(){c.zc(n);var e=c.jc().$implicit;return c.jc(2).openFeaturesModal(e.id)})),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()}2&e&&(c.Cb(1),c.Jc(" ",c.lc(2,1,"AbpTenantManagement::Permission:ManageFeatures")," "))}function J(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",35),c.hc("click",(function(){c.zc(n);var e=c.jc().$implicit;return c.jc(2).delete(e.id,e.name)})),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()}2&e&&(c.Cb(1),c.Jc(" ",c.lc(2,1,"AbpTenantManagement::Delete")," "))}function W(e,t){if(1&e&&(c.Vb(0,"tr"),c.Vb(1,"td",29),c.Vb(2,"div",30),c.Vb(3,"button",31),c.Qb(4,"i",32),c.Hc(5),c.kc(6,"abpLocalization"),c.Ub(),c.Vb(7,"div",33),c.Fc(8,R,3,3,"button",34),c.Fc(9,q,3,3,"button",34),c.Fc(10,Q,3,3,"button",34),c.Fc(11,J,3,3,"button",34),c.Ub(),c.Ub(),c.Ub(),c.Vb(12,"td"),c.Hc(13),c.Ub(),c.Ub()),2&e){var n=t.$implicit;c.Cb(5),c.Jc("",c.lc(6,6,"AbpTenantManagement::Actions")," "),c.Cb(3),c.pc("abpPermission","AbpTenantManagement.Tenants.Update"),c.Cb(1),c.pc("abpPermission","AbpTenantManagement.Tenants.ManageConnectionStrings"),c.Cb(1),c.pc("abpPermission","AbpTenantManagement.Tenants.ManageFeatures"),c.Cb(1),c.pc("abpPermission","AbpTenantManagement.Tenants.Delete"),c.Cb(2),c.Ic(n.name)}}var $=function(e,t){return{key:e,order:t}};function X(e,t){if(1&e){var n=c.Wb();c.Vb(0,"abp-table",20),c.hc("pageChange",(function(e){return c.zc(n),c.jc().onPageChange(e)})),c.kc(1,"async"),c.kc(2,"async"),c.Fc(3,x,2,1,"ng-template",null,21,c.Gc),c.Fc(5,E,9,8,"ng-template",null,22,c.Gc),c.Fc(7,W,14,8,"ng-template",null,23,c.Gc),c.Ub()}if(2&e){var a=c.yc(4),i=c.yc(6),r=c.yc(8),o=c.jc();c.pc("abpLoading",o.loading)("abpLoadingDelay",500)("abpTableSort",c.uc(15,$,o.sortKey,o.sortOrder))("colgroupTemplate",a)("headerTemplate",i)("bodyTemplate",r)("value",c.lc(1,11,o.data$))("abpTableSort",c.uc(18,$,o.sortKey,o.sortOrder))("rows",o.pageQuery.maxResultCount)("totalRecords",c.lc(2,13,o.totalCount$))("scrollable",!0)}}function Y(e,t){if(1&e&&(c.Vb(0,"h3"),c.Hc(1),c.kc(2,"abpLocalization"),c.Ub()),2&e){var n=c.jc();c.Cb(1),c.Ic(c.lc(2,1,n.selectedModalContent.title))}}function Z(e,t){1&e&&c.Rb(0)}function ee(e,t){if(1&e&&c.Fc(0,Z,1,0,"ng-container",36),2&e){var n=c.jc();c.pc("ngTemplateOutlet",null==n.selectedModalContent?null:n.selectedModalContent.template)}}function te(e,t){if(1&e){var n=c.Wb();c.Vb(0,"button",37,38),c.Hc(2),c.kc(3,"abpLocalization"),c.Ub(),c.Vb(4,"abp-button",39),c.hc("click",(function(){return c.zc(n),c.jc().save()})),c.Hc(5),c.kc(6,"abpLocalization"),c.Ub()}if(2&e){var a=c.jc();c.Cb(2),c.Jc(" ",c.lc(3,3,"AbpTenantManagement::Cancel")," "),c.Cb(2),c.pc("disabled",a.isDisabledSaveButton),c.Cb(1),c.Ic(c.lc(6,5,"AbpIdentity::Save"))}}function ne(e,t){1&e&&(c.Vb(0,"div",42),c.Vb(1,"label",43),c.Hc(2),c.kc(3,"abpLocalization"),c.Ub(),c.Qb(4,"input",46),c.Ub()),2&e&&(c.Cb(2),c.Ic(c.lc(3,1,"AbpTenantManagement::DisplayName:AdminEmailAddress")))}function ae(e,t){1&e&&(c.Vb(0,"div",42),c.Vb(1,"label",43),c.Hc(2),c.kc(3,"abpLocalization"),c.Ub(),c.Qb(4,"input",47),c.Ub()),2&e&&(c.Cb(2),c.Ic(c.lc(3,1,"AbpTenantManagement::DisplayName:AdminPassword")))}function ie(e,t){if(1&e){var n=c.Wb();c.Vb(0,"form",40),c.hc("ngSubmit",(function(){return c.zc(n),c.jc().save()})),c.Vb(1,"div",41),c.Vb(2,"div",42),c.Vb(3,"label",43),c.Hc(4),c.kc(5,"abpLocalization"),c.Ub(),c.Qb(6,"input",44),c.Ub(),c.Fc(7,ne,5,3,"div",45),c.Fc(8,ae,5,3,"div",45),c.Ub(),c.Ub()}if(2&e){var a=c.jc();c.pc("formGroup",a.tenantForm),c.Cb(4),c.Ic(c.lc(5,4,"AbpTenantManagement::TenantName")),c.Cb(3),c.pc("ngIf",a.tenantForm.controls.adminEmailAddress),c.Cb(1),c.pc("ngIf",a.tenantForm.controls.adminPassword)}}function ce(e,t){1&e&&(c.Vb(0,"div",42),c.Vb(1,"label",51),c.Hc(2),c.kc(3,"abpLocalization"),c.Ub(),c.Qb(4,"input",52),c.Ub()),2&e&&(c.Cb(2),c.Ic(c.lc(3,1,"AbpTenantManagement::DisplayName:DefaultConnectionString")))}function re(e,t){if(1&e){var n=c.Wb();c.Vb(0,"form",40),c.hc("ngSubmit",(function(){return c.zc(n),c.jc().save()})),c.Vb(1,"div",42),c.Vb(2,"div",48),c.Vb(3,"input",49),c.hc("ngModelChange",(function(e){return c.zc(n),c.jc().onSharedDatabaseChange(e)})),c.Ub(),c.Vb(4,"label",50),c.Hc(5),c.kc(6,"abpLocalization"),c.Ub(),c.Ub(),c.Ub(),c.Fc(7,ce,5,3,"div",45),c.Ub()}if(2&e){var a=c.jc();c.pc("formGroup",a.defaultConnectionStringForm),c.Cb(5),c.Ic(c.lc(6,3,"AbpTenantManagement::DisplayName:UseSharedDatabase")),c.Cb(2),c.pc("ngIf",!a.useSharedDatabase)}}function oe(e,t){if(1&e){var n=c.Wb();c.Vb(0,"abp-feature-management",53),c.hc("visibleChange",(function(e){return c.zc(n),c.jc().visibleFeatures=e})),c.Ub()}if(2&e){var a=c.jc();c.pc("visible",a.visibleFeatures)("providerKey",a.providerKey)}}var ue,se,le,be,de,pe,fe=function(){return[150,0]},me=function(){return{value:"T"}},ge=function(e){return{value:e}},he=function(e){return{value:e,twoWay:!0}},ve=function(e,t,n){return{providerName:e,providerKey:t,visible:n}},ye=function(e){return{visibleChange:e}},Ce=function(e,t){return{inputs:e,outputs:t,componentKey:"FeatureManagement.FeatureManagementComponent"}},Te=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[TenantManagement] Get Tenant",e}(),je=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[TenantManagement] Get Tenant By Id",e}(),ke=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[TenantManagement] Create Tenant",e}(),Se=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[TenantManagement] Update Tenant",e}(),Oe=function(){var e=function e(t){_classCallCheck(this,e),this.payload=t};return e.type="[TenantManagement] Delete Tenant",e}(),Fe=((le=function(){function e(t){_classCallCheck(this,e),this.rest=t}return _createClass(e,[{key:"getTenant",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.rest.request({method:"GET",url:"/api/multi-tenancy/tenants",params:e})}},{key:"getTenantById",value:function(e){return this.rest.request({method:"GET",url:"/api/multi-tenancy/tenants/".concat(e)})}},{key:"deleteTenant",value:function(e){return this.rest.request({method:"DELETE",url:"/api/multi-tenancy/tenants/".concat(e)})}},{key:"createTenant",value:function(e){return this.rest.request({method:"POST",url:"/api/multi-tenancy/tenants",body:e})}},{key:"updateTenant",value:function(e){var t="/api/multi-tenancy/tenants/".concat(e.id);return delete e.id,this.rest.request({method:"PUT",url:t,body:e})}},{key:"getDefaultConnectionString",value:function(e){return this.rest.request({method:"GET",responseType:"text",url:"/api/multi-tenancy/tenants/".concat(e,"/default-connection-string")})}},{key:"updateDefaultConnectionString",value:function(e){return this.rest.request({method:"PUT",url:"/api/multi-tenancy/tenants/".concat(e.id,"/default-connection-string"),params:{defaultConnectionString:e.defaultConnectionString}})}},{key:"deleteDefaultConnectionString",value:function(e){return this.rest.request({method:"DELETE",url:"/api/multi-tenancy/tenants/".concat(e,"/default-connection-string")})}}]),e}()).\u0275fac=function(e){return new(e||le)(c.dc(a.x))},le.\u0275prov=c.Lb({token:le,factory:le.\u0275fac,providedIn:"root"}),le.ngInjectableDef=Object(c.Lb)({factory:function(){return new le(Object(c.dc)(a.x))},token:le,providedIn:"root"}),le),Me=((se=function(){function e(t){_classCallCheck(this,e),this.tenantManagementService=t}return _createClass(e,[{key:"get",value:function(e,t){var n=e.patchState,a=t.payload;return this.tenantManagementService.getTenant(a).pipe(Object(b.a)((function(e){return n({result:e})})))}},{key:"getById",value:function(e,t){var n=e.patchState,a=t.payload;return this.tenantManagementService.getTenantById(a).pipe(Object(b.a)((function(e){return n({selectedItem:e})})))}},{key:"delete",value:function(e,t){var n=t.payload;return this.tenantManagementService.deleteTenant(n)}},{key:"add",value:function(e,t){var n=t.payload;return this.tenantManagementService.createTenant(n)}},{key:"update",value:function(e,t){var n=e.getState,a=t.payload;return this.tenantManagementService.updateTenant(Object.assign({},n().selectedItem,a))}}],[{key:"get",value:function(e){return e.result.items||[]}},{key:"getTenantsTotalCount",value:function(e){return e.result.totalCount}}]),e}()).\u0275fac=function(e){return new(e||se)(c.dc(Fe))},se.\u0275prov=c.Lb({token:se,factory:se.\u0275fac}),Object(u.b)([Object(o.a)(Te),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,Te]),Object(u.c)("design:returntype",void 0)],se.prototype,"get",null),Object(u.b)([Object(o.a)(je),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,je]),Object(u.c)("design:returntype",void 0)],se.prototype,"getById",null),Object(u.b)([Object(o.a)(Oe),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,Oe]),Object(u.c)("design:returntype",void 0)],se.prototype,"delete",null),Object(u.b)([Object(o.a)(ke),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,ke]),Object(u.c)("design:returntype",void 0)],se.prototype,"add",null),Object(u.b)([Object(o.a)(Se),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object,Se]),Object(u.c)("design:returntype",void 0)],se.prototype,"update",null),Object(u.b)([Object(o.g)(),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object]),Object(u.c)("design:returntype",Array)],se,"get",null),Object(u.b)([Object(o.g)(),Object(u.c)("design:type",Function),Object(u.c)("design:paramtypes",[Object]),Object(u.c)("design:returntype",Number)],se,"getTenantsTotalCount",null),se=Object(u.b)([Object(o.h)({name:"TenantManagementState",defaults:{result:{},selectedItem:{}}})],se)),we=((ue=function(){function e(t,n,a,i){var c=this;_classCallCheck(this,e),this.confirmationService=t,this.tenantService=n,this.fb=a,this.store=i,this.selectedModalContent={},this.visibleFeatures=!1,this.pageQuery={maxResultCount:10},this.loading=!1,this.modalBusy=!1,this.sortOrder="",this.sortKey="",this.onVisibleFeaturesChange=function(e){c.visibleFeatures=e}}return _createClass(e,[{key:"ngOnInit",value:function(){this.get()}},{key:"onSearch",value:function(e){this.pageQuery.filter=e,this.get()}},{key:"createTenantForm",value:function(){var e=this.fb.group({name:[this.selected.name||"",[s.t.required,s.t.maxLength(256)]],adminEmailAddress:[null,[s.t.required,s.t.maxLength(256),s.t.email]],adminPassword:[null,[s.t.required]]});this.hasSelectedTenant&&(e.removeControl("adminEmailAddress"),e.removeControl("adminPassword")),this.tenantForm=e}},{key:"createDefaultConnectionStringForm",value:function(){this.defaultConnectionStringForm=this.fb.group({useSharedDatabase:this._useSharedDatabase,defaultConnectionString:[this.defaultConnectionString||""]})}},{key:"openModal",value:function(e,t,n){this.selectedModalContent={title:e,template:t,type:n},this.isModalVisible=!0}},{key:"onEditConnectionString",value:function(e){var t=this;this.store.dispatch(new je(e)).pipe(Object(d.a)("TenantManagementState","selectedItem"),Object(p.a)((function(n){return t.selected=n,t.tenantService.getDefaultConnectionString(e)}))).subscribe((function(e){t._useSharedDatabase=!e,t.defaultConnectionString=e||"",t.createDefaultConnectionStringForm(),t.openModal("AbpTenantManagement::ConnectionStrings",t.connectionStringModalTemplate,"saveConnStr")}))}},{key:"addTenant",value:function(){this.selected={},this.createTenantForm(),this.openModal("AbpTenantManagement::NewTenant",this.tenantModalTemplate,"saveTenant")}},{key:"editTenant",value:function(e){var t=this;this.store.dispatch(new je(e)).pipe(Object(d.a)("TenantManagementState","selectedItem")).subscribe((function(e){t.selected=e,t.createTenantForm(),t.openModal("AbpTenantManagement::Edit",t.tenantModalTemplate,"saveTenant")}))}},{key:"save",value:function(){var e=this.selectedModalContent.type;e&&("saveTenant"===e?this.saveTenant():"saveConnStr"===e&&this.saveConnectionString())}},{key:"saveConnectionString",value:function(){var e=this;this.modalBusy||(this.modalBusy=!0,this.useSharedDatabase||!this.useSharedDatabase&&!this.connectionString?this.tenantService.deleteDefaultConnectionString(this.selected.id).pipe(Object(f.a)(1),Object(m.a)((function(){return e.modalBusy=!1}))).subscribe((function(){e.isModalVisible=!1})):this.tenantService.updateDefaultConnectionString({id:this.selected.id,defaultConnectionString:this.connectionString}).pipe(Object(f.a)(1),Object(m.a)((function(){return e.modalBusy=!1}))).subscribe((function(){e.isModalVisible=!1})))}},{key:"saveTenant",value:function(){var e=this;this.tenantForm.valid&&!this.modalBusy&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Se(Object.assign({},this.selected,this.tenantForm.value,{id:this.selected.id})):new ke(this.tenantForm.value)).pipe(Object(m.a)((function(){return e.modalBusy=!1}))).subscribe((function(){e.isModalVisible=!1,e.get()})))}},{key:"delete",value:function(e,t){var n=this;this.confirmationService.warn("AbpTenantManagement::TenantDeletionConfirmationMessage","AbpTenantManagement::AreYouSure",{messageLocalizationParams:[t]}).subscribe((function(t){t===i.m.Status.confirm&&n.store.dispatch(new Oe(e)).subscribe((function(){return n.get()}))}))}},{key:"onPageChange",value:function(e){this.pageQuery.skipCount=(e-1)*this.pageQuery.maxResultCount,this.get()}},{key:"get",value:function(){var e=this;this.loading=!0,this.store.dispatch(new Te(this.pageQuery)).pipe(Object(m.a)((function(){return e.loading=!1}))).subscribe()}},{key:"onSharedDatabaseChange",value:function(e){e||setTimeout((function(){var e=document.getElementById("defaultConnectionString");e&&e.focus()}),0)}},{key:"openFeaturesModal",value:function(e){var t=this;this.providerKey=e,setTimeout((function(){t.visibleFeatures=!0}),0)}},{key:"hasSelectedTenant",get:function(){return Boolean(this.selected.id)}},{key:"useSharedDatabase",get:function(){return this.defaultConnectionStringForm.get("useSharedDatabase").value}},{key:"connectionString",get:function(){return this.defaultConnectionStringForm.get("defaultConnectionString").value}},{key:"isDisabledSaveButton",get:function(){return!(!this.selectedModalContent||!("saveConnStr"===this.selectedModalContent.type&&this.defaultConnectionStringForm&&this.defaultConnectionStringForm.invalid||"saveTenant"===this.selectedModalContent.type&&this.tenantForm&&this.tenantForm.invalid))}}]),e}()).\u0275fac=function(e){return new(e||ue)(c.Pb(i.e),c.Pb(Fe),c.Pb(s.c),c.Pb(o.j))},ue.\u0275cmp=c.Jb({type:ue,selectors:[["abp-tenants"]],viewQuery:function(e,t){var n;1&e&&(c.Lc(N,!0),c.Lc(G,!0)),2&e&&(c.xc(n=c.ic())&&(t.tenantModalTemplate=n.first),c.xc(n=c.ic())&&(t.connectionStringModalTemplate=n.first))},decls:27,vars:26,consts:[["id","wrapper",1,"card"],[1,"card-header"],[1,"row"],[1,"col","col-md-6"],[1,"card-title"],[1,"text-right","col","col-md-6"],["id","create-tenants","class","btn btn-primary","type","button",3,"click",4,"abpPermission"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter"],["type","search",1,"form-control","form-control-sm",3,"placeholder","input.debounce"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange",4,"ngIf"],["size","md",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],["id","create-tenants","type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","mr-1"],[3,"abpLoading","abpLoadingDelay","abpTableSort","colgroupTemplate","headerTemplate","bodyTemplate","value","rows","totalRecords","scrollable","pageChange"],["tableColGroup",""],["tableHeader",""],["tableBody",""],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[3,"click"],["sortKey","name",3,"selectedSortKey","order","selectedSortKeyChange","orderChange"],["sortOrderIcon",""],[1,"text-center"],["ngbDropdown","","container","body",1,"d-inline-block"],["data-toggle","dropdown","aria-haspopup","true","ngbDropdownToggle","",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog","mr-1"],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"click",4,"abpPermission"],["ngbDropdownItem","",3,"click"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name","autofocus","",1,"form-control"],["class","form-group",4,"ngIf"],["autocomplete","email","type","email","id","admin-email-address","formControlName","adminEmailAddress",1,"form-control"],["autocomplete","new-password","type","password","id","admin-password","formControlName","adminPassword",1,"form-control"],[1,"custom-checkbox","custom-control","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"custom-control-input",3,"ngModelChange"],["for","useSharedDatabase",1,"custom-control-label"],["for","defaultConnectionString"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(e,t){1&e&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"div",2),c.Vb(3,"div",3),c.Vb(4,"h5",4),c.Hc(5),c.kc(6,"abpLocalization"),c.Ub(),c.Ub(),c.Vb(7,"div",5),c.Fc(8,K,5,3,"button",6),c.Ub(),c.Ub(),c.Ub(),c.Vb(9,"div",7),c.Vb(10,"div",8),c.Vb(11,"label"),c.Vb(12,"input",9),c.hc("input.debounce",(function(e){return t.onSearch(e.target.value)})),c.kc(13,"abpLocalization"),c.Ub(),c.Ub(),c.Ub(),c.Fc(14,X,9,21,"abp-table",10),c.Ub(),c.Ub(),c.Vb(15,"abp-modal",11),c.hc("visibleChange",(function(e){return t.isModalVisible=e})),c.Fc(16,Y,3,3,"ng-template",null,12,c.Gc),c.Fc(18,ee,1,1,"ng-template",null,13,c.Gc),c.Fc(20,te,7,7,"ng-template",null,14,c.Gc),c.Ub(),c.Fc(22,ie,9,6,"ng-template",null,15,c.Gc),c.Fc(24,re,8,5,"ng-template",null,16,c.Gc),c.Fc(26,oe,1,2,"abp-feature-management",17)),2&e&&(c.Cb(5),c.Ic(c.lc(6,7,"AbpTenantManagement::Tenants")),c.Cb(3),c.pc("abpPermission","AbpTenantManagement.Tenants.Create"),c.Cb(4),c.pc("placeholder",c.lc(13,9,"AbpUi::PagerSearch")),c.Cb(2),c.pc("ngIf",c.sc(11,fe)),c.Cb(1),c.pc("visible",t.isModalVisible)("busy",t.modalBusy),c.Cb(11),c.pc("abpReplaceableTemplate",c.uc(23,Ce,c.vc(17,ve,c.sc(12,me),c.tc(13,ge,t.providerKey),c.tc(15,he,t.visibleFeatures)),c.tc(21,ye,t.onVisibleFeaturesChange))))},directives:[a.r,a.K,h.n,i.h,a.v,i.j,i.g,i.k,h.m,h.o,i.i,r.c,r.g,r.e,r.d,h.r,i.b,s.v,s.o,a.j,P.d,s.h,s.b,P.b,s.n,s.f,a.c,s.a,L],pipes:[a.o,h.b],encapsulation:2}),Object(u.b)([Object(o.f)(Me.get),Object(u.c)("design:type",l.a)],ue.prototype,"data$",void 0),Object(u.b)([Object(o.f)(Me.getTenantsTotalCount),Object(u.c)("design:type",l.a)],ue.prototype,"totalCount$",void 0),ue),Ue=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:a.g,canActivate:[a.a,a.s],children:[{path:"tenants",component:a.u,data:{requiredPolicy:"AbpTenantManagement.Tenants",replaceableComponent:{key:"TenantManagement.TenantsComponent",defaultComponent:we}}}]}],Ve=((de=function e(){_classCallCheck(this,e)}).\u0275mod=c.Nb({type:de}),de.\u0275inj=c.Mb({factory:function(e){return new(e||de)},imports:[[g.j.forChild(Ue)],g.j]}),de),Ie=((be=function e(){_classCallCheck(this,e)}).\u0275mod=c.Nb({type:be}),be.\u0275inj=c.Mb({factory:function(e){return new(e||be)},imports:[[Ve,o.e.forFeature([Me]),P.a,a.f,i.l,r.f,z]]}),be);!function(e){e.State=function(){},e.Item=function(){},e.AddRequest=function(){},e.UpdateRequest=function(){},e.DefaultConnectionStringRequest=function(){}}(pe||(pe={}));var Ae,De=((Ae=function(){function e(t){_classCallCheck(this,e),this.store=t}return _createClass(e,[{key:"get",value:function(){return this.store.selectSnapshot(Me.get)}},{key:"getTenantsTotalCount",value:function(){return this.store.selectSnapshot(Me.getTenantsTotalCount)}},{key:"dispatchGetTenants",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.store.dispatch(_construct(Te,t))}},{key:"dispatchGetTenantById",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.store.dispatch(_construct(je,t))}},{key:"dispatchCreateTenant",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.store.dispatch(_construct(ke,t))}},{key:"dispatchUpdateTenant",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.store.dispatch(_construct(Se,t))}},{key:"dispatchDeleteTenant",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.store.dispatch(_construct(Oe,t))}}]),e}()).\u0275fac=function(e){return new(e||Ae)(c.dc(o.j))},Ae.\u0275prov=c.Lb({token:Ae,factory:Ae.\u0275fac,providedIn:"root"}),Ae.ngInjectableDef=Object(c.Lb)({factory:function(){return new Ae(Object(c.dc)(o.j))},token:Ae,providedIn:"root"}),Ae)}}]);